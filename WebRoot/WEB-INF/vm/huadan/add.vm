<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
﻿<link rel="stylesheet" type="text/css" href="${request.contextPath}/profile/default/css/common.css">
<link rel="stylesheet" href="$request.contextPath/js/ui/themes/default/om-all.css" type="text/css">
<link rel="stylesheet" type="text/css" href="${request.contextPath}/profile/validate/css/v1.css">
<script src="$request.contextPath/js/ui/jquery.min.js"></script>
<script src="$request.contextPath/js/ui/js/om-core.js"></script>
<script src="$request.contextPath/js/ui/js/om-validate.js"></script>
<script src="$request.contextPath/js/ui/js/om-button.js"></script>
<script type="text/javascript" src="$request.contextPath/js/ui/js/om-ajaxsubmit.js"></script>
<script src="$request.contextPath/js/ui/js/om-messagetip.js"></script>


  <script>
   		
  	 jQuery(document).ready(function() {
  		  $.validator.addMethod("checkMobile", function(value) {
   	        return checkMobile(value);
   	    }, "手机号码错误");
  	 	  jQuery("#dataform").validate({
  	 		onkeyup: false,
                rules : {
  	 		        "funCode" :{
  	 		  			required : true 
  	 	            },
                    "rpid" : {
                    	required : true ,
                     	maxlength : 16
                    },
                    "merId": {
                        required : true ,
                        digits :true 
                    },
                    "goodsId": {
                        required : true ,
                        digits :true 
                    },
                   
                    
                    "amount": {
                        required : true ,
                        digits : true 
                    },
                    "mobileId" : {
                    	 required : true ,
                    	 digits :true ,
                         checkMobile : true
                    },
                    "merName" :{
	                   	 required : true ,
	                   	 maxlength : 64
                     },
                     "goodsName" :{
	                   	 required : true ,
	                   	 maxlength : 64
                     }
                },
                messages : {
                    "funCode" : {
                	    required : "请选择功能码" 
                    },
                    "rpid"  : {
                        required : "请输入交易流水号",
                        maxlength : "输入长度应为16位"
                    },
                     "merId"  : {
                        required : "请输入商户号" ,
                        digits : "输入必须为数字"
                    },

                     "goodsId"  : {
                        required : "请输入商品号" ,
                        digits : "输入必须为数字"
                    },
                    "amount": {
                        required : "请输入金额" ,
                        digits : "必须输入数字"
                    },
                    "mobileId": {
                        required : "请输入手机号码" ,
                        digits : "手机号码必须为数字"
                    },
                    "merName": {
                        required : "请输入商户名称" ,
                        maxlength : "长度超过64位"
                    },
                    "goodsName": {
                        required : "请输入商品名称" ,
                        maxlength : "长度超过64位"
                    }
                },
                errorPlacement : function(error, element) { 
                    if(error.html()){
                        $(element).parents().map(function(){
                            if(this.tagName.toLowerCase()=='td'){
                                var attentionElement = $(this).next().children().eq(0);
                                attentionElement.css('display','block');
        	                    attentionElement.next().html(error);
        	                   attentionElement.next().css('display','block');
                            }
                        });
                    }
       	        },
       	        showErrors: function(errorMap, errorList) {
                    if(errorList && errorList.length > 0){
                        $.each(errorList,function(index,obj){
                            var msg = this.message;
                            $(obj.element).parents().map(function(){
       	                        if(this.tagName.toLowerCase()=='td'){
       	                            var attentionElement = $(this).next().children().eq(0);
       	                            attentionElement.show();
       	    	                    attentionElement.next().html(msg);
       	                        }
       	                    });
                        });
                    }else{
                        $(this.currentElements).parents().map(function(){
                            if(this.tagName.toLowerCase()=='td'){
                                $(this).next().children().eq(0).hide();
                                $(this).next().children().eq(1).hide();
                            }
                        });
                    }
                    this.defaultShowErrors();
                },          
                submitHandler : function(){
       				jQuery(this).submit();
                    return false;
                }
            });
  	 	 jQuery('#dataform').submit(function() {
  	 	 	if (!jQuery("#dataform").valid()) 
                 return false;
            
             jQuery(this).omAjaxSubmit({success:function(res){
               		if(res !='1') {
               		  $.omMessageTip.show({
            	            title : '操作失败',
            	            content : '添加话单信息失败，请重新添加！'
            	        });
        		   }else{
        			   $.omMessageTip.show({
        	  	            title : '操作成功',
        	  	            content : '添加话单信息成功！'
        	  	        });
        			   document.forms[0].reset();
        		   }
           		}  
            });
            
  	 });

  	 	
       
   function checkMobile(mobileId){
	   var reg=/^((13[4-9])|(15[0,1,2,7,8,9])|(18[2,3,4,7,8])|(147)){1}([0-9]{8})$/;
	   if(!reg.test(mobileId)){
			return false;
		}
	   else return true;
   }
     
      function  closeDialog(){
          window.parent.fillBackAndCloseDialog("关闭窗口,详细查看showResponse方法"); 
     }   
 

  	 } )
        
  </script>  
<div id="container" style="width:500px">
                  <form id ="dataform" method="post" name="dataform" id="dataform" action="${request.contextPath}/huadan/save.do">
                    <table width="100%" cellpadding="0" cellspacing="0" class="infowrite">
                        <tr>
                            <th width="35%" align="left"><span>*</span>请求流水号：</th>
                            <td width="15%" class="td1"><input  name="rpid" type="text"  size="30" maxlength="16" ></td>
                            <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                        <tr>
                            <th  align="left"><span>*</span>功能码：</th>
                            <td class="td">
                            <input  type='radio' id='funCode' name='funCode' value='0' >支付交易&nbsp;&nbsp;
                            <input  type='radio' id='funCode' name='funCode' value='1' >冲正交易
                            </td>
                            <td  class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                     
                       
                        <tr>
                            <th  align="left"><span>*</span>手机号：</th>
                            <td class="td1"><input  name="mobileId"  type="text"  size="30" maxlength="11"></td>
                            <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                       <tr>
                            <th  align="left"><span>*</span>商户号：</th>
                            <td class="td"><input  name="merId"  type="text"  size="30" maxlength="8"></td>
                            <td  class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      
                      <tr>
                            <th align="left"><span>*</span>商品号：</th>
                            <td class="td1"><input  name="goodsId"  type="text"  size="30" maxlength="8"></td>
                            <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      
                      <tr>
                            <th  align="left"><span>*</span>交易金额(分)：</th>
                            <td class="td">   <input  name="amount"  type="text"  size="30" maxlength="12"></td>
                            <td  class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      <tr>
                         <th  align="left"><span>*</span>商户名称：</th>
                         <td class="td1">  <input  name="merName"  type="text"  size="30" maxlength="32"></td>
                         <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                         </tr> 
                      <tr>
                         <th  align="left"><span>*</span>商品名称：</th>
                         <td class="td">  <input  name="goodsName"  type="text"  size="30" maxlength="32"></td>
                         <td " class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      <tr>
	                      <th  align="left">省代码：</th>
	                      <td class="td1"><input  name="provCode" type="text"  size="30" maxlength="4" ></td>
	                      <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
	                  </tr>
                      <tr>
	                      <th  align="left">地区代码：</th>
	                      <td class="td"><input  name="area" type="text"  size="30" maxlength="4" ></td>
	                      <td  class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
	                  </tr>
                      <tr>
                         <th  align="left">银行编号：</th>
                         <td class="td1"><input  name="bankId" type="text"  size="30" maxlength="8" ></td>
                         <td width="40%" class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      <tr>
                         <th  align="left">平台流水号：</th>
                         <td class="td"><input  name="platSeq" type="text"  size="30" maxlength="16" ></td>
                         <td  class="td"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                      </tr>
                      <tr>
	                      <th  align="left">保留：</th>
	                      <td class="td1"><input  name="reserved" type="text"  size="30" maxlength="32" ></td>
	                      <td  class="td1"> <span class="errorImg"></span><span class="errorMsg"></span></td>
                   </tr>
                     </table>
                      <table width="100%" cellpadding="0" cellspacing="0">
                          <tr>
                            <td height="15"></td>
                            <td height="15"></td>
                          </tr>
                          <tr>
                            <tr>
                            <td align="center"><input id="add_button1" name="submit" type="submit" value="添加" class="popbtn"onmouseover="this.className='popbtnhover'" onmouseout="this.className='popbtn'"/>
                            <input id="add_button2" name="add_button2" type="reset"  value="重置" class="popbtn" onmouseover="this.className='popbtnhover'" onmouseout="this.className='popbtn'" />
                          </tr>
                        </table>
                  </form>
</div>