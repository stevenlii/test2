<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<link rel="stylesheet" href="${request.contextPath}/profile/default/css/common.css" type="text/css">
<link rel="stylesheet" href="${request.contextPath}/js/ui/themes/default/om-all.css" type="text/css">
<link rel="stylesheet" type="text/css" href="${request.contextPath}/profile/default/css/zTreeStyle.css">
<link rel="stylesheet" type="text/css" href="${request.contextPath}/profile/validate/css/v1.css">
<script src="$request.contextPath/js/ui/jquery.min.js"></script>
<script src="$request.contextPath/js/ui/js/om-core.js"></script>
<script type="text/javascript" src="$request.contextPath/js/ui/js/om-ajaxsubmit.js"></script>
<script src="$request.contextPath/js/ui/js/om-mouse.js"></script>
<script src="$request.contextPath/js/ui/js/om-draggable.js"></script>
<script src="$request.contextPath/js/ui/js/om-position.js"></script>
<script src="$request.contextPath/js/ui/js/om-resizable.js"></script>
<script src="$request.contextPath/js/ui/js/om-dialog.js"></script>
<script src="$request.contextPath/js/ui/js/om-validate.js"></script>
<script src="$request.contextPath/js/ui/js/om-messagebox.js"></script>
<script src="$request.contextPath/js/ui/js/om-button.js"></script>
<script src="$request.contextPath/js/ui/js/om-combo.js"></script>
<script src="$request.contextPath/js/ui/jquery.ztree.all-3.4.js"></script>
<script src="$request.contextPath/js/busi/chnlbank.js"></script>
<script>
jQuery(document).ready(function() {
	jQuery("#container").width(jQuery(window).width());
	
	jQuery('#channelId').omCombo({
        dataSource : '$request.contextPath/option/getopenchnlidlist.do',
        width:'100px',
        listMaxHeight:210,
        forceSelection : true,
        emptyText:'请选择..',
        onValueChange:function(target,newValue,oldValue,event){ 
			getChnlNameAndTree(newValue);
	 	} 
    }); 
    
     var zNodes1="${zNodes}";		
	 var zNodes=eval(zNodes1);
	 tree=$.fn.zTree.init($("#tree"), setting, zNodes);
	 setCheck();
	     
     jQuery("#dataform").validate({
         rules : {
             "channelId" : {
             	required : true
             }
         },
         messages : {
             "channelId"  : {
                 required : "请选择渠道编号"
             }
         },
         errorPlacement : function(error, element) { 
             if(error.html()){
                 $(element).parents().map(function(){
                     if(this.tagName.toLowerCase()=='td'){
                         var attentionElement = $(this).next().children().eq(0);
                         attentionElement.css('display','block');
 	                    attentionElement.next().html(error);
 	                    attentionElement.next().css('display','block');
                     }
                 });
             }
	        },
	        showErrors: function(errorMap, errorList) {
             if(errorList && errorList.length > 0){
                 $.each(errorList,function(index,obj){
                     var msg = this.message;
                     $(obj.element).parents().map(function(){
	                        if(this.tagName.toLowerCase()=='td'){
	                            var attentionElement = $(this).next().children().eq(0);
	                            attentionElement.show();
	    	                    attentionElement.next().html(msg);
	                        }
	                    });
                 });
             }else{
                 $(this.currentElements).parents().map(function(){
                     if(this.tagName.toLowerCase()=='td'){
                         $(this).next().children().eq(0).hide();
                         $(this).next().children().eq(1).hide();
                     }
                 });
             }
             this.defaultShowErrors();
         },          
         submitHandler : function(){
				jQuery(this).submit();
             return false;
         }
     });
     
});

</script>
</head>
<body>
<!--商户银行配置页面-->
<div id="container">
<form id ="dataform" method="post" name="dataform">
     <table width="100%" border="0" cellspacing="0" cellpadding="0">
       <tr>
         <td><table cellpadding="0" cellspacing="0" class="infowrite">
           <tr>
             <th width="25%"><span>*</span>渠道编号：</th>
             <td class="td">
               <input id="channelId" name="channelId" class="select1"/>
               </td>
               <td class="td" width="140px"><span class="errorImg"></span><span class="errorMsg"></span></td>
            </tr>
           <tr>
             <th width="25%"><span>*</span>渠道名称：</th>
             <td class="td1" colspan="2"><label id="channelName"></label></td>
            </tr>
           <tr>
             <th width="25%"><span>*</span>上线省份：</th>
             <td class="td" colspan="2">
             	<input id="bankId" name="bankId" type="hidden">
		         <div style="width:100%;height:240px;text-align:left;overflow:auto;">
				      <ul id="tree" class="ztree"></ul>
			       </div>
             </td>
           </tr>
          </table>
        </td>
      </tr>
     </table>
     <div class="pop_btn_sh">
	   <input type="button" class="popbtn" onmouseover="this.className='popbtnhover'" onmouseout="this.className='popbtn'" value="确定" onclick="update()"/>
	   <input type="button" class="popbtn" onmouseover="this.className='popbtnhover'" onmouseout="this.className='popbtn'" value="取消" onclick="closeDialog()"/>
	 </div>
   </div>
 </form>
 </div>
 </body>
</html>